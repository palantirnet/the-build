<?xml version="1.0"?>
<project name="install" default="install">
    <!--
        This can be used to install the build template into a project.
      -->


    <import file="configure.xml" />


    <!-- Target: install -->
    <target name="install" description="Install the Phing build template into your project.">
        <!-- Copy the Vagrantfile template. -->
        <copy file="${phing.dir.install}/../build.dist.xml" tofile="${application.startdir}/build.xml" overwrite="true">
            <filterchain>
                <replacetokens>
                    <token key="projectname" value="${projectname}"/>
                </replacetokens>
            </filterchain>
        </copy>
        
        <!-- Copy the drush alias script -->
        <copy file="${vagrant.bin.source}/drush" tofile="${vagrant.bin.dest}/drush"/>

        <!-- Copy the build configuration. -->
        <mkdir dir="${application.startdir}/conf" />
        <copy todir="${application.startdir}/conf/drupal">
            <fileset dir="${phing.dir.install}/../conf/drupal" />
        </copy>

        <echo message="Configure the default environment..." />
        <phingcall target="configure-defaults" />
        <phingcall target="configure-drush">
            <property name="build.env" value="default" />
        </phingcall>

        <echo message="To configure properties for more environments, run: vendor/bin/phing configure" />
    </target>

</project>
